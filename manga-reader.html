<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Окугуч</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="bootstrap.min.css">

</head>
<body>
    <!-- Include the navbar -->
    <div id="navbar"></div>
    <div class="reader">
        <div class="loader"></div>
        <img id="manga-page" src="pages/page1.jpg" alt="Manga Page">
        <div class="controls">
          <div class="control" id="prev" style="left: 0;">&#9664;</div>
          <div class="control" id="next" style="right: 0;">&#9654;</div>
        </div>
    </div>
    <div class="page-selector">
        <select id="page-dropdown"></select>
    </div>
      
    <script>
        fetch('navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar').innerHTML = data;
            });

            const pages = [
                'pages/page1.jpg',
                'pages/page2.jpg',
                'pages/page3.jpg',
                'pages/page4.jpg',
                'pages/page5.jpg',
                'pages/page6.jpg',
                'pages/page7.jpg',
                'pages/page8.jpg',
                'pages/page9.jpg'

            ];

            const mangaTitle = 'Manga 1';

            let currentPage = 0;

            const imgElement = document.getElementById('manga-page');
            const prevButton = document.getElementById('prev');
            const nextButton = document.getElementById('next');
            const pageDropdown = document.getElementById('page-dropdown');

            function updatePage() {
                document.querySelector('.reader').classList.add('loading');
                imgElement.classList.add('loading');
                imgElement.src = pages[currentPage];
                pageDropdown.value = currentPage;
                
                // Save current page to localStorage
                localStorage.setItem(`${mangaTitle}_currentPage`, currentPage);
            }

            function loadSavedPage() {
                const savedPage = localStorage.getItem(`${mangaTitle}_currentPage`);
                if (savedPage !== null) {
                    currentPage = parseInt(savedPage);
                    updatePage();
                }
            }

            function populateDropdown() {
                for (let i = 0; i < pages.length; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Page ${i + 1}`;
                    pageDropdown.appendChild(option);
                }
            }

            imgElement.onload = function () {
                document.querySelector('.reader').classList.remove('loading');
                imgElement.classList.remove('loading');
            };

            prevButton.addEventListener('click', () => {
                if (currentPage > 0) {
                    currentPage--;
                    updatePage();
                }
            });

            nextButton.addEventListener('click', () => {
                if (currentPage < pages.length - 1) {
                    currentPage++;
                    updatePage();
                }
            });

            pageDropdown.addEventListener('change', (event) => {
                currentPage = parseInt(event.target.value);
                updatePage();
            });

            document.addEventListener('keydown', (event) => {
                if (event.key === 'ArrowLeft') {
                    if (currentPage > 0) {
                        currentPage--;
                        updatePage();
                    }
                } else if (event.key === 'ArrowRight') {
                    if (currentPage < pages.length - 1) {
                        currentPage++;
                        updatePage();
                    }
                }
            });

            // Initialize the page
            populateDropdown();
            loadSavedPage();
            updatePage();
    </script>
</body>
</html>
